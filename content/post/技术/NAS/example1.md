---
title: 我的NAS架设之路
subtitle: 
date: "2021-02-01T00:00:00+08:00"
# lastmod: 2021-08-15T21:17:52+08:00
summary: 如何架设和部署一套NAS系统，提供媒体中心、网盘、下载器等服务
comments: true
categories: ["技术", "NAS"]
tags: ["NAS", "软路由","pve","jellyfin","aria2","nextcloud","minecraft"]
toc: true
---

　　2019 年初，我由部队转业在家，闲着无聊，就折腾了一下家里的网络，进行了一些小的改造，之前一直想做没时间做的 NAS 架设也就提上了日程。

　　最开始使用了一套 PVE 架构，_Proxmox Virtual Environment_ ，也就是服务虚拟化的玩意，如图
![f2Y63R.png](https://z3.ax1x.com/2021/08/15/f2Y63R.md.png)
　　pve 中起了一个 lede 软路由，一个 debian 系统安装 omv，另外还装了一个 windows 平时不怎么开启。但是这种架构对于个人自建小 NAS 来说有一些问题，比如 pve 自身占用一定资源、结构和配置复杂等，而虚拟化系统的灵活部署等优点却无法体现，最终因为 NAS 系统需要硬解码，而显卡直通出的一系列问题很难解决，导致我最终选择了直接在 NAS 服务器中安装一套 debian 系统，在 NAS 和光猫之间放了一个 Nanopi R2S 的软路由，并一直沿用至今。
![f2U3ND.md.png](https://z3.ax1x.com/2021/08/15/f2U3ND.md.png)

## 硬件篇

### 硬件列表 + 成本

|                    | 价格             | 备注                                                         |
| ------------------ | ---------------- | ------------------------------------------------------------ |
| NanoPi R2S         | 289              | NanoPi R2S风扇金属壳，双千兆网口                             |
| 机箱+电源          | 347              | [金河田预见N2 + 集成王300电源 + 静音风扇                     |
| 主板+内存          | 828              | J3455-ITX 迷你ITX主板四核主板 + 4Gx2  DDR3 1600              |
| USB 3.0扩展卡+耗材 | 59               | 主板带2个usb 3.0和 2个usb 2.0，可以自己扩展                  |
| UPS                | 514              | APC施耐德BK650-CH                                            |
| 千兆交换机         | 80               | 水星SG108M 8口                                               |
| 千兆网卡           | 130              | J3455自带一个千兆口，pve方案不够，debian方案一个就够了       |
| 硬盘               | 1707（两块酷狼） | 至今，一共装了2个4T希捷酷狼，一个旧的300G的2.5硬盘，机箱只有2个3.5硬盘位，2个2.5硬盘位 |

所以我一共投入的资金大约是 3954元。 如果和白群晖什么的对比的话，只计算机箱内并除去硬盘成本，也就是1175元。 所以折腾的原因就是**穷**



## 系统/服务篇

### 服务列表

|          | 使用的软件系统 | 备注                                         |
| -------- | -------------- | -------------------------------------------- |
| 媒体服务 | jellyfin       | 媒体中心，电影连续剧等各种资源               |
| 下载服务 | aria2          | 挂着下载资源，自持bt 磁力，不支持电驴        |
| 网盘服务 | nextcloud      | 自建网盘，存储分享资源，很方便               |
| 我的世界 | minecraft      | 给女儿架的我的世界服务器，一个冒险，一个创造 |
| samba    | samba          | 文件共享                                     |
|          |                |                                              |

### 域名、公网IP、ddns



### 软路由



### docker

基本上所有的服务都是通过docker运行的，使用的是docker-compose

#### install docker

https://docs.docker.com/engine/install/

#### install docker-compose

https://docs.docker.com/compose/install/

### 媒体中心

### 备份任务

